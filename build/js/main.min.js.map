{"version":3,"file":"main.min.js","sources":["main.min.js"],"sourcesContent":["'use strict';\r\n\r\nconst API = 'https://raw.githubusercontent.com/GeekBrainsTutorial/online-store-api/master/responses';\r\n\r\n\r\n\r\n//Конструктор для создания списка товаров на странице\r\n\r\nclass GoodsList {\r\n  constructor(container = '.products') {\r\n    this.container = container;\r\n    this.goods = [];\r\n    this.allProducts = [];\r\n    this.filteredGoods = [];\r\n    this._makeGETRequest()\r\n      .then(data => {\r\n        this.goods = [...data];\r\n        this.filteredGoods = [...data];\r\n        this.render();\r\n      });\r\n  }\r\n\r\n  _makeGETRequest() {\r\n    return fetch(`${API}/catalogData.json`)\r\n      .then(result => result.json())\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let block = '';\r\n    this.filteredGoods.forEach(good => {\r\n      const goodItem = new GoodsItem(good);\r\n      block += goodItem.render();\r\n    });\r\n    document.querySelector(this.container).innerHTML = block;\r\n    console.log(this.filteredGoods);\r\n    if (this.filteredGoods.length == 0) {\r\n      console.log(this.filteredGoods);\r\n      document.querySelector(this.container).innerHTML = '<p>Соответствий не найдено</p>';\r\n    }\r\n  }\r\n\r\n  filterGoods(value) {\r\n    const regexp = new RegExp(value, 'i');\r\n    this.filteredGoods = this.goods.filter(good => regexp.test(good.product_name));\r\n    this.render();\r\n  }\r\n\r\n\r\n\r\n\r\n} //end GoodsList\r\n\r\n\r\n\r\n//Конструктор для создания товара на странице\r\nclass GoodsItem {\r\n  constructor(product, img = 'img/noimage.jpg', title = 'Product Name', price = 'Is unknown') {\r\n    this.id = product.id_product;\r\n    this.img = product.img || img;\r\n    this.title = product.product_name || title;\r\n    this.price = product.price || price;\r\n  }\r\n  render() {\r\n    return `<div class='products__item' data-id=\"${this.id}\">\r\n            <img src=${this.img} class='products__item-img' alt='Изображение товара'>\r\n            <h3 class='products__item-title'>${this.title}</h3>\r\n            <p class='products__item-text'>${this.price} rub.</p>\r\n            <button class='products__item-btn'>Add</button>\r\n          </div>`;\r\n  }\r\n}\r\n\r\nlet list = new GoodsList();\r\n\r\n// Поиск\r\nconst searchBtn = document.querySelector('.search__btn');\r\nconst searchInput = document.querySelector('.search__input');\r\n\r\nsearchBtn.addEventListener('click', (e) => {\r\n  const value = searchInput.value;\r\n  list.filterGoods(value);\r\n});\r\n\r\n//Конструктор для создания корзины \r\n\r\nclass CartList {\r\n\r\n  constructor(container = '.cart-popup__content') {\r\n    this.container = container;\r\n    this.goods = [];\r\n    this.allProducts = [];\r\n    this._makeGETRequest()\r\n      .then(data => {\r\n        this.goods = [...data.contents];\r\n        this.amount = data.amount;\r\n        this.countGoods = data.countGoods;\r\n        this.render();\r\n        this.delete();\r\n      });\r\n\r\n  }\r\n\r\n  _makeGETRequest() {\r\n    return fetch(`${API}/getBasket.json`)\r\n      .then(result => result.json())\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const block = document.querySelector(this.container);\r\n    const countGoods = document.querySelector('#countGoods');\r\n    const amount = document.querySelector('#amount');\r\n    for (let product of this.goods) {\r\n      const cartObj = new CartItem(product);\r\n      this.allProducts.push(cartObj);\r\n      block.insertAdjacentHTML('beforeend', cartObj.render());\r\n    }\r\n    countGoods.insertAdjacentHTML('beforeend', this.countGoods);\r\n    amount.insertAdjacentHTML('beforeend', `${this.amount} руб.`);\r\n  }\r\n\r\n  delete() { //Удалить товар из корзины      \r\n    for (let product of this.allProducts) {\r\n      let btnDelete = document.querySelectorAll('.cart-popup__list-item--delete');\r\n      for (let item of btnDelete) {\r\n        item.addEventListener('click', () => {\r\n          item.parentElement.remove(product);\r\n        });\r\n      }\r\n    }\r\n  } //end delete()\r\n\r\n  recalculateAmountOfProducts() {} //  Пересчитать общую сумму всех товаров\r\n\r\n  placeOrder() {} // Оформить заказ\r\n\r\n} // end CartList\r\n\r\n\r\n//Конструктор для создания элемента корзины \r\n\r\nclass CartItem {\r\n  constructor(product, img = 'img/noimage.jpg', title = 'Product Name', price = 'Is unknown', quantity = 1) {\r\n    this.id = product.id_product;\r\n    this.img = product.img || img;\r\n    this.title = product.product_name || title;\r\n    this.price = product.price || price;\r\n    this.quantity = product.quantity || quantity;\r\n  }\r\n\r\n  render() {\r\n    return ` <ul class=\"cart-popup__list\">\r\n              <li class=\"cart-popup__list-item\" data-id=\"${this.id}\">\r\n                <img src=\"${this.img}\" alt=\"Изображение товара\">\r\n              </li>\r\n              <li class=\"cart-popup__list-item\">${this.title}</li>\r\n              <li class=\"cart-popup__list-item\">${this.price} руб.</li>\r\n              <li class=\"cart-popup__list-item\">${this.quantity}</li>\r\n              <li class=\"cart-popup__list-item\">${this.price * this.quantity} руб.</li>\r\n              <li class=\"cart-popup__list-item cart-popup__list-item--delete\" title=\"Удалить товар\">\r\n                <img class=\"cart-popup__delete\" src=\"img/delete-from-cart.ico\" alt=\"Удалить товар\">\r\n              </li>\r\n            </ul>`;\r\n  }\r\n\r\n  increaseProductQuantity() {} // Увеличить количество товара\r\n\r\n  reduceProductQuantity() {} // Уменьшить количество товара\r\n\r\n\r\n  recalculateAmountOfProduct() {} // Пересчитать сумму товара, в зависимости от количества\r\n\r\n}\r\n\r\nlet cartList = new CartList();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Открытие модального окна корзины\r\nconst cart = document.querySelector('.cart-button');\r\nconst cartPopup = document.querySelector('.cart-popup');\r\n\r\ncart.addEventListener('click', () => {\r\n  cartPopup.classList.add('open');\r\n});\r\n\r\n// Закрытие модального окна корзины\r\nconst cartPopupClose = document.querySelector('.cart-popup__close');\r\n\r\ncartPopupClose.addEventListener('click', () => {\r\n  cartPopup.classList.remove('open');\r\n});\r\n\r\n\r\n\r\n// const goods = [{\r\n//     img: 'img/good-1.jpg',\r\n//     title: 'Shirt',\r\n//     price: 150\r\n//   },\r\n//   {\r\n//     img: 'img/good-2.jpg',\r\n//     title: 'Socks',\r\n//     price: 50\r\n//   },\r\n//   {\r\n//     img: 'img/good-3.jpg',\r\n//     title: 'Jacket',\r\n//     price: 350\r\n//   },\r\n//   {\r\n//     img: 'img/good-4.jpg',\r\n//     title: 'Shoes',\r\n//     price: 250\r\n//   },\r\n//   {},\r\n// ];\r\n\r\n// const renderGoodsItem = (img = 'img/noimage.jpg', title = 'Product Name', price = 'Is unknown') => {\r\n//   return `<div class='goods-item'>\r\n//             <img src=${img} class='goods-item__img' alt='Изображение товара'>\r\n//             <h3 class='goods-item__title'>${title}</h3>\r\n//             <p class='goods-item__text'>${price} rub.</p>\r\n//             <button class='goods-item__btn'>Add</button>\r\n//           </div>`;\r\n\r\n// };\r\n\r\n// const renderGoodsList = (list) => {\r\n//   let goodsList = list.map(item => renderGoodsItem(item.img, item.title, item.price));\r\n//   // document.querySelector('.goods-list').innerHTML = goodsList.join('');\r\n//   document.querySelector('.goods-list').innerHTML = list.map(item => renderGoodsItem(item.img, item.title, item.price)).join('');\r\n// };\r\n\r\n// const renderGoodsList = (list) => {\r\n//   let goodsList = list.map(item => renderGoodsItem(item.img, item.title, item.price));\r\n//   // document.querySelector('.goods-list').innerHTML = goodsList.join('');\r\n//   document.querySelector('.goods-list').innerHTML = list.map(item => renderGoodsItem(item.img, item.title, item.price)).join('');\r\n// };\r\n\r\n// renderGoodsList(goods);"],"names":["API","GoodsList","container","this","goods","allProducts","filteredGoods","_makeGETRequest","then","data","render","fetch","result","json","catch","error","console","log","block","forEach","good","goodItem","GoodsItem","document","querySelector","innerHTML","length","value","regexp","RegExp","filter","test","product_name","product","img","title","price","id","id_product","list","searchBtn","searchInput","addEventListener","filterGoods","CartList","contents","amount","countGoods","delete","cartObj","CartItem","push","insertAdjacentHTML","item","querySelectorAll","parentElement","remove","quantity","cartList","cart","cartPopup","classList","add","cartPopupClose"],"mappings":"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"}